<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head}" th:with="pageTitle=${language != null and language == 'en' ? 'Philosophy - Login' : '哲学 - 登录'}">
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-smooth {
                transition: all 0.3s ease-in-out;
            }
        }
    </style>
</head>
<body class="bg-secondary min-h-screen flex flex-col">
    <div th:replace="~{fragments/header :: header}"></div>
    
    <main class="min-h-screen flex items-center justify-center p-4 pt-24">
        <div class="max-w-md w-full bg-white rounded-lg shadow-md overflow-hidden">
            <div class="p-6">
                <h2 class="text-2xl font-bold text-center text-gray-700 mb-6" th:if="${language != null and language == 'en'}" th:text="'Login'">Login</h2>
                <h2 class="text-2xl font-bold text-center text-gray-700 mb-6" th:unless="${language != null and language == 'en'}" th:text="'登录'">登录</h2>
                
                <!-- 消息提示将通过JavaScript显示 -->
                
                <form th:action="@{/login}" method="post">
                    <!-- 隐藏字段：重定向URL -->
                    <input type="hidden" th:name="redirect" th:value="${param.redirect}" />
                    <div class="mb-4">
                        <label for="username" class="block text-gray-700 mb-2" th:if="${language != null and language == 'en'}" th:text="'Username'">Username</label>
                        <label for="username" class="block text-gray-700 mb-2" th:unless="${language != null and language == 'en'}" th:text="'用户名'">用户名</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                                <i class="fa fa-user"></i>
                            </span>
                            <input type="text" id="username" name="username" 
                                   class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                   th:if="${language != null and language == 'en'}" th:placeholder="'Please enter username'" required>
                                   <input type="text" id="username" name="username" 
                                   class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                   th:unless="${language != null and language == 'en'}" th:placeholder="'请输入用户名'" required>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label for="password" class="block text-gray-700 mb-2" th:if="${language != null and language == 'en'}" th:text="'Password'">Password</label>
                        <label for="password" class="block text-gray-700 mb-2" th:unless="${language != null and language == 'en'}" th:text="'密码'">密码</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                                <i class="fa fa-lock"></i>
                            </span>
                            <input type="password" id="password" name="password" 
                                   class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                   th:if="${language != null and language == 'en'}" th:placeholder="'Please enter password'" required>
                                   <input type="password" id="password" name="password" 
                                   class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                   th:unless="${language != null and language == 'en'}" th:placeholder="'请输入密码'" required>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <input type="checkbox" id="remember-me" name="remember-me" 
                                   class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded">
                            <label for="remember-me" class="ml-2 block text-gray-700" th:if="${language != null and language == 'en'}" th:text="'Remember me'">Remember me</label>
                            <label for="remember-me" class="ml-2 block text-gray-700" th:unless="${language != null and language == 'en'}" th:text="'记住我'">记住我</label>
                        </div>
                    </div>
                    
                    <button type="submit" 
                            class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200">
                        <span th:if="${language != null and language == 'en'}" th:text="'Login'">Login</span>
                        <span th:unless="${language != null and language == 'en'}" th:text="'登录'">登录</span>
                    </button>
                </form>
                
                <div class="mt-6 text-center">
                    <p class="text-gray-600">
                        <span th:if="${language != null and language == 'en'}" th:text="'Don\'t have an account?'">Don't have an account?</span>
                        <span th:unless="${language != null and language == 'en'}" th:text="'还没有账号?'">还没有账号?</span> 
                        <a href="/register" class="text-primary hover:text-primary/80 font-medium" th:if="${language != null and language == 'en'}" th:text="'Register now'">Register now</a>
                        <a href="/register" class="text-primary hover:text-primary/80 font-medium" th:unless="${language != null and language == 'en'}" th:text="'立即注册'">立即注册</a>
                    </p>
                </div>
            </div>
        </div>
    </main>
    
    <div th:replace="~{fragments/footer :: footer}"></div>
    <div th:replace="~{fragments/footer :: language-switcher-script}"></div>
    <div th:replace="~{fragments/footer :: search-script}"></div>
    <div th:replace="~{fragments/footer :: search-modal}"></div>
    <div th:replace="~{fragments/footer :: message-script}"></div>

    <script>
        // 页面加载时检查URL参数并显示消息
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const language = /*[[${language}]]*/ 'zh';
            
            if (urlParams.has('success')) {
                const message = language === 'en' ? 'Operation successful' : '操作成功';
                showMessage(message, 'success');
            }
            
            if (urlParams.has('error')) {
                const message = language === 'en' ? 'Username or password incorrect, please try again' : '用户名或密码错误，请重试';
                showMessage(message, 'error');
            }
            
            if (urlParams.has('logout')) {
                const message = language === 'en' ? 'You have successfully logged out' : '您已成功登出';
                showMessage(message, 'success');
            }
        });
    </script>
</body>
</html>
    